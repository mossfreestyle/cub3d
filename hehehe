# TODO Cub3D - Suivi de la progression dÃ©taillÃ©

---

## ğŸŸ¢ PARSING

### âœ… DÃ©jÃ  fait
- âœ… Lecture du fichier map avec GNL
- âœ… Parsing des textures et couleurs (NO, SO, WE, EA, F, C)
- âœ… VÃ©rification de l'unicitÃ© des textures et couleurs
- âœ… VÃ©rification de l'extension `.xpm` pour les textures
- âœ… VÃ©rification de l'extension `.cub` pour le fichier map
- âœ… VÃ©rification que la map est le dernier Ã©lÃ©ment du fichier
- âœ… Gestion des lignes vides dans la map
- âœ… VÃ©rification du nombre de joueurs (exactement 1)
- âœ… RÃ©cupÃ©ration de la position et de la direction du joueur
- âœ… VÃ©rification des caractÃ¨res valides dans la map
- âœ… Remplissage des espaces vides par un caractÃ¨re spÃ©cifique (`X`)
- âœ… VÃ©rification que la map est bien fermÃ©e par des murs (`check_is_closed`)
- âœ… Gestion des erreurs et libÃ©ration mÃ©moire
- âœ… VÃ©rification des valeurs RGB (0-255)
- âœ… VÃ©rification du format RGB (3 valeurs sÃ©parÃ©es par des virgules)
- âœ… Correction du bug 'W' vs 'O' dans `get_nb_players`
- âœ… Correction de l'allocation mÃ©moire dans `set_up_final_map`
- âœ… Correction des boucles dans `check_is_closed`
- âœ… Correction de `recup_gnl` pour Ã©viter les memory leaks

### ğŸŸ¡ Ã€ faire / Ã€ amÃ©liorer

#### ğŸ”¸ Robustesse parsing
- [ ] **VÃ©rifier que le joueur n'est pas sur un bord de la map**  
  â†’ Le joueur ne doit jamais Ãªtre placÃ© sur la premiÃ¨re/derniÃ¨re ligne ou colonne.
- [ ] **VÃ©rifier que le joueur ne touche pas un espace ou un bord**  
  â†’ Les cases autour du joueur doivent Ãªtre des murs ou des cases valides.
- [ ] **VÃ©rifier l'existence rÃ©elle des fichiers de textures**  
  â†’ Ouvrir chaque chemin avec `open()`, vÃ©rifier l'accessibilitÃ©, et que le fichier est bien un `.xpm`.
- [ ] **GÃ©rer les cas limites**  
  â†’ Map non rectangulaire, lignes trÃ¨s longues, caractÃ¨res inattendus, plusieurs blocs de map, etc.
- [ ] **Ajouter des messages d'erreur plus prÃ©cis**  
  â†’ Indiquer la ligne et la nature exacte de l'erreur.
- [ ] **Tester avec tous les maps de test**  
  â†’ Valider le parsing avec les maps `bad/`, `invalid/`, `valid/`, etc.
- [ ] **Nettoyer et commenter le code pour la relecture finale**

#### ğŸ”¸ Bonus parsing (optionnel)
- [ ] **Supporter les maps avec plusieurs blocs sÃ©parÃ©s par des lignes vides**  
  â†’ S'assurer que seul le bloc contenant le joueur est gardÃ©.
- [ ] **VÃ©rifier que la map ne contient pas de caractÃ¨res interdits mÃªme dans les lignes vides**

---

## ğŸŸ¦ EXECUTION / RAYCASTING

### âœ… DÃ©jÃ  fait
- âœ… Initialisation des structures player, map, assets, key
- âœ… Hooks clavier de base (WASD, ESC)
- âœ… DÃ©but du raycasting (fonction DDA prÃ©sente)
- âœ… Structures de donnÃ©es pour le raycasting

### ğŸŸ¡ Ã€ faire / Ã€ amÃ©liorer

#### ğŸ”¸ Affichage et moteur
- [ ] **RÃ©activer l'initialisation MLX**  
  â†’ DÃ©commenter `init_mlx()` dans `init_all()` pour crÃ©er la fenÃªtre.
- [ ] **Affichage des murs avec textures**  
  â†’ Charger les fichiers `.xpm` avec `mlx_xpm_file_to_image()`, appliquer la texture sur les murs selon la direction du rayon.
- [ ] **Affichage du sol et du plafond**  
  â†’ Colorier les pixels du sol et du plafond selon la couleur dÃ©finie dans la map.
- [ ] **Gestion correcte des collisions avec les murs et les espaces vides**  
  â†’ EmpÃªcher le joueur de traverser les murs ou les cases remplies (`X`).
- [ ] **Gestion de la rotation du joueur (gauche/droite)**  
  â†’ Modifier l'angle de vue avec les touches flÃ©chÃ©es ou la souris.
- [ ] **Gestion des angles et du FOV**  
  â†’ S'assurer que le rendu respecte bien le champ de vision.
- [ ] **Optimisation du raycasting**  
  â†’ Correction du fish-eye, gestion des distances, optimisation des calculs.
- [ ] **Gestion de la fermeture propre de la fenÃªtre (croix, ESC)**
- [ ] **Gestion des erreurs lors du chargement des textures**  
  â†’ VÃ©rifier que `mlx_xpm_file_to_image()` rÃ©ussit.
- [ ] **RÃ©activer la game loop**  
  â†’ DÃ©commenter `handle_events()` et `mlx_loop()` dans `main()`.

#### ğŸ”¸ Bonus exÃ©cution (optionnel)
- [ ] **Effets visuels (shading, animation, etc.)**
- [ ] **Affichage d'un HUD minimal**

---

## â­ï¸ BONUS

### ğŸŸ¡ Ã€ faire

#### ğŸ”¸ Mini-map
- [ ] **Affichage d'une mini-map Ã  l'Ã©cran**  
  â†’ Vue du dessus, position du joueur, murs, direction du regard.

#### ğŸ”¸ Collisions avancÃ©es
- [ ] **Collision prÃ©cise avec les murs**  
  â†’ EmpÃªcher le joueur de traverser les murs mÃªme en diagonale ou en glissant sur les bords.

#### ğŸ”¸ Mouvement de la souris
- [ ] **Gestion du mouvement de la souris pour tourner la vue**  
  â†’ Capter les mouvements horizontaux de la souris pour faire tourner la camÃ©ra.

#### ğŸ”¸ (Optionnel)
- [ ] **Portes, objets interactifs, HUD avancÃ©, sons, etc.**

---

## ğŸ”§ BUGS CORRIGÃ‰S

### âœ… RÃ©cemment corrigÃ©s
- âœ… **Bug 'W' vs 'O' dans `get_nb_players`** - Correction de la comparaison de caractÃ¨res
- âœ… **Allocation incorrecte dans `set_up_final_map`** - Correction de l'allocation mÃ©moire
- âœ… **Segfault dans `check_is_closed`** - Correction des boucles et vÃ©rifications
- âœ… **Memory leak dans `recup_gnl`** - Correction de la libÃ©ration mÃ©moire
- âœ… **VÃ©rification extension `.cub`** - Correction de la vÃ©rification du nom de fichier
- âœ… **Double tours dans `is_valid`** - Correction de la logique de validation
- âœ… **Padding avec 'X' au lieu d'espaces** - Correction du remplissage de la map

---

## ğŸ“ RÃ©capitulatif progression

- **Parsing** : 85% âœ…  
  (parsing fonctionnel, reste surtout la robustesse et les tests finaux)
- **Raycasting/exÃ©cution** : 15% ğŸŸ¡  
  (structures prÃªtes, reste tout l'affichage et la game loop)
- **Bonus** : 0% ğŸ”´  
  (Ã  commencer aprÃ¨s le core)

---

## ğŸ¯ **Prochaines Ã©tapes prioritaires**

1. **Finaliser les tests de parsing** avec toutes les maps de test
2. **VÃ©rifier l'existence des fichiers de textures** avec `open()`
3. **RÃ©activer l'initialisation MLX** et la fenÃªtre
4. **Charger les textures** avec `mlx_xpm_file_to_image()`
5. **ImplÃ©menter l'affichage raycasting** de base
6. **Ajouter les collisions** et le mouvement du joueur

---

## ğŸ§ª TESTS Ã€ FAIRE

### Maps Ã  tester :
- `maps/maps/bad/` - Toutes les maps invalides
- `maps/maps/invalid/` - Maps avec erreurs diverses
- `maps/maps/valid/` - Maps valides
- `maps/maps/perso/` - Maps personnalisÃ©es

### Cas limites :
- Fichiers inexistants
- Permissions insuffisantes
- Maps trÃ¨s grandes
- Textures inexistantes
- Valeurs RGB limites (0, 255)
- Double virgules dans RGB
- CaractÃ¨res spÃ©ciaux

---

**Ã‰tat actuel : Parsing quasi terminÃ©, prÃªt pour l'exÃ©cution ! ğŸš€**